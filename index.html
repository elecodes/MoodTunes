<!doctype html>
<html lang="en">

<head>
  <meta charset="UTF-8" />
  <link rel="icon" type="image/svg+xml" href="/vite.svg" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>MoodTunes</title>
  <link rel="stylesheet" href="App.css" />

</head>

<body>
  <!-- ðŸ”¹ Navbar fijo -->
  <nav class="navbar">
    <div class="navbar-brand">ðŸŽµ MoodTunes</div>
    <ul class="navbar-links">
      <li><a href="#">Home</a></li>
      <li><a href="#">Songs</a></li>
      <li><a href="#">Favorites</a></li>
      <li><a href="#">About</a></li>
    </ul>
  </nav>

  <!-- ðŸ”¹ Contenedor React -->
  <div id="root"></div>
  <script type="module" src="/src/main.jsx"></script>
  <script type="text/javascript">
    (function (d, t) {
      console.log("Voiceflow: Initializing widget script...");
      var v = d.createElement(t), s = d.getElementsByTagName(t)[0];

      v.onload = function () {
        console.log("Voiceflow: Script loaded. Initializing chat...");
        window.voiceflow.chat.load({
          verify: { projectID: '696d1ce1879820474bf9d87a' },
          url: 'https://general-runtime.voiceflow.com',
          versionID: 'production',
          voice: {
            url: "https://runtime-api.voiceflow.com"
          },
          render: {
            mode: 'overlay'
          },
          assistant: {
            extensions: [
              {
                name: 'MusicHandler',
                type: 'response',
                match: (trace) => trace.payload && trace.payload.search_terms,
                render: ({ trace, element }) => {
                  console.log("Voiceflow: Music extension triggered", trace);
                  if (window.handleVoiceflowMusic) {
                    window.handleVoiceflowMusic(trace.payload.search_terms);
                  }
                  element.innerHTML = '<div style="font-size: 0.8em; color: #666; margin-top: 5px;">ðŸŽµ Searching music...</div>';
                }
              }
            ]
          }
        }).then(() => console.log("Voiceflow: Chat loaded successfully"))
          .catch((err) => console.error("Voiceflow: Chat load failed", err));
      }

      v.onerror = function (e) {
        console.error("Voiceflow: Script failed to load", e);
      };

      v.src = "https://cdn.voiceflow.com/widget-next/bundle.mjs"; v.type = "text/javascript"; s.parentNode.insertBefore(v, s);
    })(document, 'script');
  </script>
</body>

</html>